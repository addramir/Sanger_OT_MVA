pchidq(100,df=1,low=F)
pchisq(100,df=1,low=F)
pchisq(200,df=1,low=F)
pchisq(300,df=1,low=F)
pchisq(400,df=1,low=F)
pchisq(500,df=1,low=F)
pchisq(400,df=1,low=F)
pchisq(500,df=1,low=F)
load("../Dropbox/ss/All_rg.Rdata")
df=Correlation_matrix
df[df>1]=1
df[df<(-1)]=-1
diag(df)=1
table(is.na(df))
l1=apply(df,MAR=1,FUN=function(x){sum(is.na(x))})/nrow(df)
l2=apply(df,MAR=2,FUN=function(x){sum(is.na(x))})/nrow(df)
table(l1==l2)
table(l1>0.9)
table(l1>0.001)
hist(l1)
table(l1>0.001)
table(l1>0.001)
table(l1>0.005)
table(l1>0.0001)
table(l1>0.00001)
table(l1<0.00001)
df=df[l1<0.005,l1<0.005]
l1=apply(df,MAR=1,FUN=function(x){sum(is.na(x))})/nrow(df)
hist(l1)
df=df[l1<0.001,l1<0.001]
l1=apply(df,MAR=1,FUN=function(x){sum(is.na(x))})/nrow(df)
hist(l1)
table(l1)
df=df[l1<0.0001,l1<0.0001]
l1=apply(df,MAR=1,FUN=function(x){sum(is.na(x))})/nrow(df)
hist(l1)
dim(df)
dst=as.dist(2*(1-abs(df)))
dst=as.dist((1-(df)^2))
l=hclust(d=dst,method="ward.D2")
df=df[l$order,l$order]
library(corrplot)
corrplot(df,method="square",tl.pos='n')
hist(l1)
ll=eigen(df)
sum((ll$values/618)[1:88])
sum((ll$values/618)[1:88])
sum(ll$values[1:88])/sum(ll$values)
sum(ll$values[1:190])/sum(ll$values)
sum(ll$values[1:150])/sum(ll$values)
sum(ll$values[1:100])/sum(ll$values)
grps=cutree(l,k = 88)
table(grps)
clstr=12
names(grps)[grps==clstr]
corrplot(df[names(grps)[grps==clstr],names(grps)[grps==clstr]],method="square")
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
dim(dfff)
dwt(dfff)
det(dfff)
eigen(dfff)
sum(eigen(dfff)$values)
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
dff=df
dff[abs(dff)<0.7]=0
#dst=as.dist(2*(1-abs(df)))
dst=as.dist((1-(dff)^2))
l=hclust(d=dst,method="ward.D2")
dff=dff[l$order,l$order]
ll=eigen(dff)
sum(ll$values[1:100])/sum(ll$values)
sum(ll$values[1:200])/sum(ll$values)
sum(ll$values[1:180])/sum(ll$values)
sum(ll$values[1:190])/sum(ll$values)
sum(ll$values[1:190])/sum(ll$values)
grps=cutree(l,k = 190)
lll=table(grps)
lll
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
clstr=2
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
plot(cmdscale(dst,k = 2))
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
corrplot(dfff,method="square")
clstr=3
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
clstr=4
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
clstr=5
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
clstr=190
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
dff
dfff
grps=cutree(l,k = 500)
lll=table(grps)
ll=eigen(dff)
sum(ll$values[1:190])/sum(ll$values)
grps=cutree(l,k = 500)
lll=table(grps)
clstr=190
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
clstr=1
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
clstr=2
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
ll=eigen(dff)
sum(ll$values[1:190])/sum(ll$values)
grps=cutree(l,k = 500)
eigen(1)
i=190
out_m=array(NA,c(1000,2))
for (i in 190:1000){
grps=cutree(l,k = i)
lll=table(grps)
out=NULL
for (j in 1:i){
clstr=j
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
out=c(out,eigen(dfff)$values[1]/sum(eigen(dfff)$values))
}
out_m[i-189,1]=i
out_m[i-189,2]=min(out)
}
eigen(1)
щге_ь
out_m
plot(out_m)
out_m[,2])>=0.95
out_m[,2]>=0.95
min(out_m[,2]>=0.95)
ind=whcih(out_m[,2]>=0.95)
min(ind)
ind=which(out_m[,2]>=0.95)
min(ind)
out_m[min(ind),]
clstr=2
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
grps=cutree(l,k = 619)
lll=table(grps)
clstr=2
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
grps=cutree(l,k = 619)
lll=table(grps)
clstr=100
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
lll
table(lll>1)
clstr=10
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
clstr=200
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
clstr=300
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
ll=eigen(dff)
sum(ll$values[1:190])/sum(ll$values)
out_m
plot(out_m[,2])
ind=which(out_m[,2]>=0.95)
out_m[min(ind),]
grps=cutree(l,k = 619)
lll=table(grps)
clstr=300
names(grps)[grps==clstr]
dfff=df[names(grps)[grps==clstr],names(grps)[grps==clstr]]
corrplot(dfff,method="square")
eigen(dfff)$values[1]/sum(eigen(dfff)$values)
table(lll>1)
hist(lll)
hist(lll,n=20)
hist(lll[lll>1],n=20)
table(lll)
plot(cmdscale(dst,k = 2))
library(data.table)
lll
grps
table("FINNGEN_R6_PDSTRICT"%in%names(grps))
table("FINNGEN_R6_PDSTRICT_EXMORE"%in%names(grps))
names(grps)
table("FINNGEN_R6_PD_DEMENTIA_EXMORE"%in%names(grps))
l=names(grps)
table("SAIGE_332"%in%names(grps))
length(l)
table("NEALE2_20107_11"%in%names(grps))
l=c("	FINNGEN_R6_PDSTRICT	",
"	FINNGEN_R6_PDSTRICT_EXMORE	",
"	FINNGEN_R6_PD_DEMENTIA	",
"	FINNGEN_R6_PD_DEMENTIA_EXMORE	",
"	FINNGEN_R6_G6_PARKINSON	",
"	FINNGEN_R6_G6_PARKINSON_EXMORE	",
"	FINNGEN_R6_G6_PARKINSON_INCLAVO	",
"	FINNGEN_R6_G6_PARKSCND	",
"	NEALE2_20002_1262	",
"	NEALE2_20107_11	",
"	NEALE2_20110_11	",
"	NEALE2_20111_11	",
"	GCST90000014	",
"	GCST90000015	",
"	SAIGE_332	")
l
lll=c("FINNGEN_R6_PDSTRICT",
"FINNGEN_R6_PDSTRICT_EXMORE",
"FINNGEN_R6_PD_DEMENTIA",
"FINNGEN_R6_PD_DEMENTIA_EXMORE",
"FINNGEN_R6_G6_PARKINSON",
"FINNGEN_R6_G6_PARKINSON_EXMORE",
"FINNGEN_R6_G6_PARKINSON_INCLAVO",
"FINNGEN_R6_G6_PARKSCND",
"NEALE2_20002_1262",
"NEALE2_20107_11",
"NEALE2_20110_11",
"NEALE2_20111_11",
"GCST90000014",
"GCST90000015",
"SAIGE_332")
table(lll%in%names(grps))
si=fread("study_index.csv",data.table=F)
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
library(data.table)
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
index=paste(si$trait_reported,si$n_initial,si$num_assoc_loci,sep = "_")
table(duplicated(index))
ind=which(duplicated(index) & si[,"num_assoc_loci"]>0)
dups=unique(index[ind])
y=si[index%in%dups,]
si_s=si[si$has_sumstats==TRUE,]
ind=grep(si_s$trait_reported,pattern = "Parkinson")
ind1=grep(si_s$trait_reported,pattern = "parkinson")
ind=unique(c(ind,ind1))
y=si_s[ind,]
View(y)
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
si_s=si[si$has_sumstats==TRUE,]
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
library(data.table)
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
si_s=si[si$has_sumstats==TRUE,]
library(data.table)
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
si=fread("C://Projects/Sanger_OT_MVA/03_mva_draft/study_index.csv",data.table=F)
index=paste(si$trait_reported,si$n_initial,si$num_assoc_loci,sep = "_")
table(duplicated(index))
ind=which(duplicated(index) & si[,"num_assoc_loci"]>0)
dups=unique(index[ind])
y=si[index%in%dups,]
si_s=si[si$has_sumstats==TRUE,]
ind=grep(si_s$trait_reported,pattern = "Parkinson")
ind1=grep(si_s$trait_reported,pattern = "parkinson")
ind=unique(c(ind,ind1))
y=si_s[ind,]
View(y)
setwd("C://Projects/Sanger_OT_MVA/03_mva_draft/")
x=fread("mva_results_with_clst_name.txt",data.table=F)
library(data.table)
x=fread("mva_results_with_clst_name.txt",data.table=F)
x=fread("mva_results_with_clst_name.txt",data.table=F,sep="\t")
x
View(x)
x=fread("mva_results_with_clst_name.txt",data.table=F,sep="\t")
grepl(pattern = ";",x$EFOs)
table(!grepl(pattern = ";",x$EFOs) & x$EFOs!="")
x$h2s
strsplit(x$h2s,";")
lst=strsplit(x$h2s,";")
i=1
lst[[i]]
as.numeric(lst[[i]])
h2s=max(as.numeric(lst[[i]]))
h2_exp=x$expected_h2_gip1[i]
h2_exp/h2s
i=1
out=NULL
for (i in 1:208){
h2s=max(as.numeric(lst[[i]]))
h2_exp=x$expected_h2_gip1[i]
out=c(out,h2_exp/h2s)
}
summary(out)
